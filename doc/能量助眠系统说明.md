# ⚡😴 能量/助眠双轨系统说明

## 🎯 设计理念

同一个活动（如阅读、运动）从两个不同的角度理解：
- **能量视角** - 消耗型，关注"还能做多少"
- **助眠视角** - 累积型，关注"能睡多好"

用户可以自由切换视角，看到不同的数据呈现！

---

## 📊 系统架构

### 脑力系统（Mental）

| 视角 | 属性名 | 范围 | 初始值 | 变化方向 |
|------|--------|------|--------|----------|
| **能量视角** | 脑力值 (mentalPower) | -∞ ~ 100 | 100 | ⬇️ 消耗 |
| **助眠视角** | 心理助眠值 (mentalSleepAid) | 0 ~ +∞ | 0 | ⬆️ 累积 |

**触发活动：** 阅读、学习、思考、计算等脑力活动

### 体力系统（Physical）

| 视角 | 属性名 | 范围 | 初始值 | 变化方向 |
|------|--------|------|--------|----------|
| **能量视角** | 体力值 (physicalPower) | -∞ ~ 100 | 100 | ⬇️ 消耗 |
| **助眠视角** | 身体助眠值 (physicalSleepAid) | 0 ~ +∞ | 0 | ⬆️ 累积 |

**触发活动：** 运动、体力劳动等身体活动

---

## 🔄 活动效果示例

### 📚 阅读100页书

**能量视角：**
```
脑力值: 100 → 80 (-20)
体力值: 100 → 100 (不变)
```

**助眠视角：**
```
心理助眠值: 0 → 15 (+15)
身体助眠值: 0 → 0 (不变)
```

**同时发生！只是从不同角度看！**

---

### 🏃 跑步1小时

**能量视角：**
```
脑力值: 100 → 100 (不变)
体力值: 100 → 75 (-25)
```

**助眠视角：**
```
心理助眠值: 0 → 0 (不变)
身体助眠值: 0 → 20 (+20)
```

---

### 💼 工作8小时（脑力+体力）

**能量视角：**
```
脑力值: 100 → 40 (-60)
体力值: 100 → 60 (-40)
```

**助眠视角：**
```
心理助眠值: 0 → 45 (+45)
身体助眠值: 0 → 30 (+30)
```

---

## 😴 睡眠质量计算

### 公式

```typescript
睡眠质量 = 基础值 + (心理助眠值 × 0.2) + (身体助眠值 × 0.2)
```

### 示例

**场景1：只阅读，没运动**
```
基础睡眠质量: 60
心理助眠值: 50 → 加成 +10
身体助眠值: 0 → 加成 +0
最终睡眠质量: 70分
```

**场景2：既阅读又运动（理想状态）**
```
基础睡眠质量: 60
心理助眠值: 80 → 加成 +16
身体助眠值: 100 → 加成 +20
最终睡眠质量: 96分！✨
```

**场景3：助眠值超过100**
```
基础睡眠质量: 60
心理助眠值: 120 → 加成 +24
身体助眠值: 150 → 加成 +30
最终睡眠质量: 100分（封顶）💯
```

---

## 🎮 与任务系统的集成

### 创建任务时可以设置：

```javascript
// 阅读任务
{
  title: "阅读书100页",
  category: "mental",
  rewards: [
    { type: "intelligence", amount: 1 },
    { type: "gold", amount: 10 }
  ],
  effects: {
    mentalPower: -20,        // 消耗脑力
    mentalSleepAid: +15      // 增加心理助眠
  }
}

// 运动任务
{
  title: "跑步5公里",
  category: "physical",
  rewards: [
    { type: "strength", amount: 1 },
    { type: "gold", amount: 15 }
  ],
  effects: {
    physicalPower: -25,       // 消耗体力
    physicalSleepAid: +20     // 增加身体助眠
  }
}
```

---

## 💡 使用场景

### 场景1：工作日晚上

**状态：**
- 脑力值：30（工作用脑过度）
- 体力值：70（没怎么动）
- 心理助眠值：60
- 身体助眠值：10

**建议：**
- ⚠️ **能量视角**显示脑力不足，不适合再学习
- 💡 但**助眠视角**显示身体助眠值低
- ✅ 推荐：轻度运动30分钟（散步、瑜伽）
  - 体力值：70 → 55（还能承受）
  - 身体助眠值：10 → 25（提升睡眠质量）

---

### 场景2：周末早上

**状态：**
- 脑力值：100（刚睡醒）
- 体力值：100（精力充沛）
- 心理助眠值：0（刚清零）
- 身体助眠值：0（刚清零）

**建议：**
- ✅ **能量视角**显示状态满格
- 🎯 可以安排高强度活动
- 推荐顺序：
  1. 上午运动（体力充沛）
  2. 下午阅读（脑力充沛）
  3. 晚上两个助眠值都高 → 睡眠质量好！

---

### 场景3：过度工作警告

**状态：**
- 脑力值：-10（已透支！）
- 体力值：20（接近耗尽）
- 心理助眠值：80（很高）
- 身体助眠值：40（中等）

**系统提示：**
- 🚨 **能量视角**：脑力已透支，必须休息！
- 💤 **助眠视角**：助眠值充足，适合睡觉
- ⚠️ 继续工作会严重影响健康和效率

---

## 🔧 自定义配置（未来可扩展）

### 活动效果系数

```typescript
const ACTIVITY_EFFECTS = {
  reading: {
    mentalPower: -0.2,      // 每分钟消耗0.2脑力
    mentalSleepAid: +0.15,  // 每分钟累积0.15助眠
  },
  running: {
    physicalPower: -0.4,     // 每分钟消耗0.4体力
    physicalSleepAid: +0.3,  // 每分钟累积0.3助眠
  },
  // ... 更多活动
};
```

### 睡眠质量公式系数

```typescript
const SLEEP_QUALITY_CONFIG = {
  baseQuality: 60,           // 基础睡眠质量
  mentalCoefficient: 0.2,    // 心理助眠系数
  physicalCoefficient: 0.2,  // 身体助眠系数
  maxQuality: 100,           // 最高睡眠质量
};
```

---

## 🎯 设计优势

1. **直观切换** - 同一数据，两种视角，满足不同需求
2. **科学合理** - 符合真实生理规律
3. **动机明确**
   - 能量视角：提醒休息（负反馈）
   - 助眠视角：激励活动（正反馈）
4. **平衡指引** - 引导用户脑力和体力均衡活动
5. **可扩展** - 未来可添加更多视角（如压力视角、专注视角等）

---

## 🚀 开始使用

1. 打开应用，找到"⚡😴 能量/助眠切换面板"
2. 点击"⚡ 能量"或"😴 助眠"按钮切换视角
3. 使用测试按钮模拟活动，观察数值变化
4. 完成真实任务后，系统会自动更新这些数值

**享受双轨系统带来的全新体验！** 🎮✨
