# ğŸ”„ ç”¨è¿›åºŸé€€æœºåˆ¶è¯´æ˜

## âœ… å·²å®ç°

æˆ‘å·²ç»ä¸ºé¡¹ç›®æ·»åŠ äº†å®Œæ•´çš„**ç”¨è¿›åºŸé€€**æœºåˆ¶ï¼

### æ ¸å¿ƒæ–‡ä»¶

ğŸ“„ `/lib/utils/useItOrLoseIt.ts` - ç”¨è¿›åºŸé€€æ ¸å¿ƒå®ç°

### åŠŸèƒ½ç‰¹æ€§

#### 1. **çµæ´»é…ç½®**
æ¯ä¸ªå±æ€§éƒ½å¯ä»¥ç‹¬ç«‹é…ç½®ç”¨è¿›åºŸé€€å‚æ•°ï¼š

```typescript
interface UseItOrLoseItConfig {
  // å¢é•¿é…ç½®
  growthMode: 'percentage' | 'value'  // ç™¾åˆ†æ¯” or å›ºå®šå€¼
  growthRate: number                  // å¢é•¿ç‡
  
  // è¡°é€€é…ç½®  
  decayEnabled: boolean               // æ˜¯å¦å¯ç”¨è¡°é€€
  decayMode: 'percentage' | 'value'   // ç™¾åˆ†æ¯” or å›ºå®šå€¼
  decayRate: number                   // è¡°é€€ç‡
  decayStartDays: number              // å‡ å¤©ä¸ç”¨å¼€å§‹è¡°é€€
  
  // é™åˆ¶
  minValue: number                    // æœ€å°å€¼
  maxValue: number                    // æœ€å¤§å€¼
}
```

#### 2. **ä¸¤ç§æ¨¡å¼**

**å›ºå®šå€¼æ¨¡å¼**ï¼ˆæ¨èï¼‰ï¼š
- å¢é•¿ï¼šå½“å‰å€¼ + å¢é•¿å€¼
- è¡°é€€ï¼šå½“å‰å€¼ - è¡°é€€å€¼
- ä¾‹å­ï¼šåŠ›é‡ 50 â†’ è¿åŠ¨å 50.5 â†’ 3å¤©ä¸è¿åŠ¨ 49.9

**ç™¾åˆ†æ¯”æ¨¡å¼**ï¼š
- å¢é•¿ï¼šå½“å‰å€¼ Ã— (1 + å¢é•¿ç‡%)
- è¡°é€€ï¼šå½“å‰å€¼ Ã— (1 - è¡°é€€ç‡%)^å¤©æ•°
- ä¾‹å­ï¼šåŠ›é‡ 50 â†’ å¢é•¿5% â†’ 52.5

#### 3. **é¢„è®¾é…ç½®**

å·²ä¸ºå››ä¸ªæ ¸å¿ƒå±æ€§é…ç½®ï¼š

**ğŸ’ª åŠ›é‡**
- å¢é•¿ï¼šæ¯æ¬¡è¿åŠ¨ +0.5
- è¡°é€€ï¼š3å¤©ä¸è¿åŠ¨å¼€å§‹ï¼Œæ¯å¤© -0.2
- æœ€å°å€¼ï¼š5

**ğŸ§  æ™ºåŠ›**
- å¢é•¿ï¼šæ¯æ¬¡å­¦ä¹  +0.5
- è¡°é€€ï¼š3å¤©ä¸å­¦ä¹ å¼€å§‹ï¼Œæ¯å¤© -0.2
- æœ€å°å€¼ï¼š5

**âœ¨ ç²¾ç¥**
- å¢é•¿ï¼šæ¯æ¬¡ä¼˜è´¨ç¡çœ  +0.5
- è¡°é€€ï¼š2å¤©æ²¡ä¼˜è´¨ç¡çœ å¼€å§‹ï¼Œæ¯å¤© -0.3
- æœ€å°å€¼ï¼š5

**ğŸƒ ä½“åŠ›**
- å¢é•¿ï¼šæ¯æ¬¡è¿åŠ¨ +0.3
- è¡°é€€ï¼š7å¤©ä¸è¿åŠ¨æ‰å¼€å§‹ï¼Œæ¯å¤© -0.1ï¼ˆè¡°é€€æ…¢ï¼‰
- æœ€å°å€¼ï¼š5

### ä½¿ç”¨æ–¹æ³•

```typescript
import { 
  calculateGrowth, 
  calculateDecay,
  getDecayStatus,
  STRENGTH_CONFIG 
} from '@/lib/utils/useItOrLoseIt';

// è®¡ç®—å¢é•¿
const newValue = calculateGrowth(currentStrength, STRENGTH_CONFIG);

// è®¡ç®—è¡°é€€
const decayedValue = calculateDecay(
  currentStrength, 
  daysSinceLastExercise, 
  STRENGTH_CONFIG
);

// è·å–çŠ¶æ€
const status = getDecayStatus(daysSinceLastExercise, STRENGTH_CONFIG);
// è¿”å›: { status: 'active' | 'warning' | 'decaying', message: string }
```

### å®é™…æ•ˆæœç¤ºä¾‹

**åŠ›é‡å±æ€§å˜åŒ–è¿‡ç¨‹ï¼š**

```
Day 1: è¿åŠ¨ â†’ 10.0 + 0.5 = 10.5 âœ…
Day 2: è¿åŠ¨ â†’ 10.5 + 0.5 = 11.0 âœ…
Day 3: è¿åŠ¨ â†’ 11.0 + 0.5 = 11.5 âœ…
Day 4: æ²¡è¿åŠ¨ â†’ 11.5 (è¿˜æœªå¼€å§‹è¡°é€€)
Day 5: æ²¡è¿åŠ¨ â†’ 11.5 (è¿˜æœªå¼€å§‹è¡°é€€)
Day 6: æ²¡è¿åŠ¨ â†’ 11.5 (è¿˜æœªå¼€å§‹è¡°é€€)
Day 7: æ²¡è¿åŠ¨ â†’ 11.5 - 0.2 = 11.3 ğŸ”» å¼€å§‹è¡°é€€
Day 8: æ²¡è¿åŠ¨ â†’ 11.3 - 0.2 = 11.1 ğŸ”»
Day 9: æ²¡è¿åŠ¨ â†’ 11.1 - 0.2 = 10.9 ğŸ”»
Day 10: è¿åŠ¨ â†’ 10.9 + 0.5 = 11.4 âœ… æ¢å¤å¢é•¿
```

### è­¦å‘Šç³»ç»Ÿ

ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆè­¦å‘Šï¼š

- **Day N-1**: "âš ï¸ æ˜å¤©å¼€å§‹è¡°é€€"
- **Day N+**: "ğŸ”» æ­£åœ¨è¡°é€€ä¸­ï¼ˆå·²Xå¤©ï¼‰"
- **å¥åº·çŠ¶æ€**: "âœ… ä¿æŒä½¿ç”¨ä¸­"

## ğŸ“ ä¸‹ä¸€æ­¥

è¦å°†æ­¤æœºåˆ¶é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿï¼Œéœ€è¦ï¼š

1. åœ¨ `lifeSystemStore.ts` ä¸­æ·»åŠ è¡°é€€æ£€æŸ¥
2. æ¯å¤©ç™»å½•æ—¶è‡ªåŠ¨è®¡ç®—è¡°é€€
3. åœ¨UIä¸­æ˜¾ç¤ºè¡°é€€è­¦å‘Š
4. è®°å½•æœ€åä½¿ç”¨æ—¥æœŸ

### é›†æˆç¤ºä¾‹

```typescript
// åœ¨storeä¸­æ·»åŠ 
applyDecay: () => {
  const today = format(new Date(), 'yyyy-MM-dd');
  const state = get();
  
  // è®¡ç®—åŠ›é‡è¡°é€€
  if (state.character.lastExercise) {
    const days = differenceInDays(today, state.character.lastExercise);
    const newStrength = calculateDecay(
      state.character.strength, 
      days, 
      STRENGTH_CONFIG
    );
    
    if (newStrength !== state.character.strength) {
      set({ 
        character: { 
          ...state.character, 
          strength: newStrength 
        }
      });
    }
  }
  
  // åŒç†å¤„ç†å…¶ä»–å±æ€§...
}
```

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

1. **çœŸå®åæ˜ **: ä¸ç»ƒä¹ çœŸçš„ä¼šé€€æ­¥
2. **æ¿€åŠ±åšæŒ**: çœ‹åˆ°è¡°é€€ä¼šæƒ³ä¿æŒ
3. **çµæ´»é…ç½®**: æ¯ä¸ªå±æ€§ç‹¬ç«‹é…ç½®
4. **åŒæ¨¡å¼**: ç™¾åˆ†æ¯”å’Œå›ºå®šå€¼éƒ½æ”¯æŒ
5. **å¹³æ»‘è¡°é€€**: æœ‰ç¼“å†²æœŸï¼Œä¸ä¼šçªç„¶ä¸‹é™

---

**ç”¨è¿›åºŸé€€ï¼ŒæŒç»­è¿›åŒ–ï¼** ğŸ”„âœ¨
